// Create inserts the {{ .Struct.Name }} to the database.
{{- if .Struct.Deprecated }}
// %EMPTY_COMMENT%
// Deprecated: {{ .Struct.Name }} is no longer maintained
{{- end }}
func (r *{{ .Struct.Name }}) Create(db Queryer) error {
  return r.CreateContext(context.Background(), db)
}

// Get{{ .Struct.Name }}ByPk select the {{ .Struct.Name }} from the database.
{{- if .Struct.Deprecated }}
//
// Deprecated: {{ .Struct.Name }} is no longer maintained
{{- end }}
func Get{{ .Struct.Name }}ByPk(db Queryer, {{ createSelectByPkFuncParams .Struct }}) (*{{ .Struct.Name }}, error) {
  return Get{{ .Struct.Name }}ByPkContext(context.Background(), db, {{ createSelectByPkSQLParams .Struct }})
}

// CreateContext inserts the {{ .Struct.Name }} to the database.
{{- if .Struct.Deprecated }}
//
// Deprecated: {{ .Struct.Name }} is no longer maintained
{{- end }}
func (r *{{ .Struct.Name }}) CreateContext(ctx context.Context, db Queryer) error {
    {{- if .Struct.Table.AutoGenPk }}
        err := db.QueryRowContext(ctx,
            `{{ createInsertSQL .Struct }}`,
            {{ createInsertParams .Struct }}).Scan({{ createInsertScan .Struct }})
    {{- else }}
        _, err := db.ExecContext(ctx,
            `{{ createInsertSQL .Struct }}`,
            {{ createInsertParams .Struct }})
    {{- end }}
	if err != nil {
        return errors.WithStack(err)
	}
	return nil
}

// CreateOnConflictDoNothing inserts the {{ .Struct.Name }} to the database.
// If a conflict occurs (e.g., unique constraint violation), the insert is skipped without error.
// Returns true if the row was inserted, false if it was skipped due to conflict.
{{- if .Struct.Deprecated }}
//
// Deprecated: {{ .Struct.Name }} is no longer maintained
{{- end }}
func (r *{{ .Struct.Name }}) CreateOnConflictDoNothing(ctx context.Context, db Queryer) (bool, error) {
    {{- if .Struct.Table.AutoGenPk }}
        err := db.QueryRowContext(ctx,
            `{{ createInsertOnConflictDoNothingSQL .Struct }}`,
            {{ createInsertParams .Struct }}).Scan({{ createInsertScan .Struct }})
        if err != nil {
            if err == sql.ErrNoRows {
                return false, nil
            }
            return false, errors.WithStack(err)
        }
        // Row was successfully inserted
        return true, nil
    {{- else }}
        result, err := db.ExecContext(ctx,
            `{{ createInsertOnConflictDoNothingSQL .Struct }}`,
            {{ createInsertParams .Struct }})
        if err != nil {
            return false, errors.WithStack(err)
        }
        rowsAffected, err := result.RowsAffected()
        if err != nil {
            return false, errors.WithStack(err)
        }
        return rowsAffected > 0, nil
    {{- end }}
}

// Get{{ .Struct.Name }}ByPkContext select the {{ .Struct.Name }} from the database.
{{- if .Struct.Deprecated }}
//
// Deprecated: {{ .Struct.Name }} is no longer maintained
{{- end }}
func Get{{ .Struct.Name }}ByPkContext(ctx context.Context, db Queryer, {{ createSelectByPkFuncParams .Struct }}) (*{{ .Struct.Name }}, error) {
    var r {{ .Struct.Name }}
    err := db.QueryRowContext(ctx,
        `{{ createSelectByPkSQL .Struct }}`,
        {{ createSelectByPkSQLParams .Struct }}).Scan({{ createSelectByPkScan .Struct }})
	if err != nil {
        return nil, errors.WithStack(err)
	}
	return &r, nil
}
